import{r as n,j as e,a as h}from"./app-_a53eJXV.js";import{U as g}from"./user-D2vO7lib.js";import{M as y}from"./mail-CO_xYnud.js";import"./createLucideIcon-mfdPizJi.js";const j=({onUploadSuccess:o,initialImageUrl:t=null,uploadUrl:u=null})=>{const c=n.useRef(null),[m,l]=n.useState(t),[i,a]=n.useState(!1);n.useEffect(()=>{l(t)},[t]);const s=r=>{const x=r.target.files[0];if(!x)return;const b=new FileReader;if(b.onload=p=>{l(p.target.result)},b.readAsDataURL(x),u){a(!0);const p=new FormData;p.append("image",x),fetch(u,{method:"POST",body:p,headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json"}}).then(async f=>{const d=await f.json();f.ok&&d.success?(o(d.url,d.path),l(d.url)):(alert("Error: "+(d.message||"No se pudo subir la imagen")),l(t))}).catch(f=>{console.error("Error:",f),alert("Error de conexión"),l(t)}).finally(()=>a(!1))}c.current&&(c.current.value="")};return e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-6 flex flex-col items-center border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"relative group",children:[m?e.jsx("img",{src:m,alt:"Foto de perfil",className:"w-32 h-32 object-cover rounded-full mb-4 border-4 border-white shadow-md"}):e.jsx("div",{className:"w-32 h-32 bg-gray-100 rounded-full mb-4 flex items-center justify-center border-2 border-dashed border-gray-300",children:e.jsx("span",{className:"text-gray-400 text-sm text-center px-2",children:"Sin foto"})}),i&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/20 rounded-full mb-4",children:e.jsx("div",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"})})]}),e.jsx("input",{type:"file",ref:c,onChange:s,accept:"image/*",className:"hidden"}),e.jsx("button",{type:"button",onClick:()=>c.current?.click(),disabled:i,className:"px-4 py-2 bg-gray-800 text-white text-xs font-bold rounded-full hover:bg-gray-700 transition-all disabled:opacity-50 uppercase tracking-wider",children:i?"Cargando...":"Cambiar Imagen"}),e.jsx("h3",{className:"mt-3 text-sm font-semibold text-gray-900",children:"Foto de perfil"}),e.jsx("p",{className:"text-[11px] text-gray-500 mt-1 text-center",children:"Esta foto será visible para otros usuarios."})]})},C=()=>{const[o,t]=n.useState({name:"",email:"",avatar:null}),[u,c]=n.useState(!0);n.useEffect(()=>{(async()=>{try{const r=await(await fetch("/api/user/basic-profile")).json();t({name:r.name||"",email:r.email||"",avatar:r.profile?.avatar_url||null})}catch(s){console.error("Error cargando perfil:",s),t(r=>({...r,avatar:null}))}finally{c(!1)}})()},[]);const m=(a,s)=>{t(r=>({...r,avatar:a})),h.reload({only:["auth"]})},l=(a,s)=>{t(r=>({...r,[a]:s}))},i=async a=>{a.preventDefault();try{(await fetch("/api/user/basic-profile",{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({name:o.name,email:o.email})})).ok?(alert("¡Perfil actualizado con éxito!"),h.reload({only:["auth"]})):alert("Hubo un problema al guardar los cambios.")}catch(s){console.error("Error:",s)}};return u?e.jsx("div",{className:"max-w-xl mx-auto text-center py-20 text-gray-400 italic",children:"Cargando..."}):e.jsx("div",{className:"max-w-xl mx-auto",children:e.jsxs("form",{onSubmit:i,className:"space-y-8",children:[e.jsx(j,{initialImageUrl:o.avatar,uploadUrl:route("upload.avatar"),onUploadSuccess:m}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"group",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-2 ml-1",children:"Nombre de usuario"}),e.jsxs("div",{className:"relative",children:[e.jsx(g,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",value:o.name,onChange:a=>l("name",a.target.value),className:"w-full pl-10 pr-4 py-3 bg-white border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500",required:!0})]})]}),e.jsxs("div",{className:"group",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-2 ml-1",children:"Correo electrónico"}),e.jsxs("div",{className:"relative",children:[e.jsx(y,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"email",value:o.email,onChange:a=>l("email",a.target.value),className:"w-full pl-10 pr-4 py-3 bg-white border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500",required:!0})]})]})]}),e.jsx("div",{className:"pt-2",children:e.jsx("button",{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-3.5 rounded-xl font-bold shadow-lg",children:"Guardar cambios del perfil"})})]})})};export{C as default};
