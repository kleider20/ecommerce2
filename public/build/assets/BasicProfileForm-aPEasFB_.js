import{r as n,j as e}from"./app-CU0P3dLZ.js";import{U as g}from"./user-amanYjy-.js";import{M as y}from"./mail-Bal37zAN.js";import"./createLucideIcon-CiwuWYqI.js";const j=({onUploadSuccess:s,onPreviewChange:i,initialImageUrl:b=null,uploadUrl:u=null})=>{const o=n.useRef(null),[d,x]=n.useState(b),[c,m]=n.useState(!1),a=r=>{const t=r.target.files[0];if(!t)return;const h=new FileReader;if(h.onload=p=>{const l=p.target.result;x(l),i&&i(l)},h.readAsDataURL(t),u){m(!0);const p=new FormData;p.append("image",t),fetch(u,{method:"POST",body:p,headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json"}}).then(async l=>{const f=await l.json();l.ok&&f.success?s(f.url,f.path):alert("Error: "+(f.message||"No se pudo subir la imagen"))}).catch(l=>{console.error("Error de red:",l),alert("Error de conexión al servidor. Verifique Laragon.")}).finally(()=>m(!1))}o.current&&(o.current.value="")};return e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative group",children:[d?e.jsx("img",{src:d,alt:"Vista previa",className:"w-32 h-32 object-cover rounded-full mb-4 border-4 border-white shadow-md transition-opacity group-hover:opacity-75"}):e.jsx("div",{className:"w-32 h-32 bg-gray-100 rounded-full mb-4 flex items-center justify-center border-2 border-dashed border-gray-300",children:e.jsx("span",{className:"text-gray-400 text-xs text-center px-2",children:"Sin foto"})}),c&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/20 rounded-full mb-4",children:e.jsx("div",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"})})]}),e.jsx("input",{type:"file",ref:o,onChange:a,accept:"image/*",className:"hidden"}),e.jsx("button",{type:"button",onClick:()=>o.current?.click(),disabled:c,className:"px-4 py-2 bg-gray-800 text-white text-xs font-bold rounded-full hover:bg-gray-700 transition-all disabled:opacity-50 uppercase tracking-wider",children:c?"Cargando...":"Cambiar Imagen"})]})},k=()=>{const[s,i]=n.useState({name:"",email:"",avatar:""}),[b,u]=n.useState(!0),[o,d]=n.useState(!1);n.useEffect(()=>{(async()=>{try{const t=await(await fetch("/api/user/basic-profile")).json();i({name:t.name||"",email:t.email||"",avatar:t.profile?.avatar_url||null})}catch(r){console.error("Error cargando perfil:",r)}finally{u(!1)}})()},[]);const x=(a,r)=>{i(t=>({...t,avatar:a}))},c=(a,r)=>{i(t=>({...t,[a]:r}))},m=async a=>{a.preventDefault(),d(!0);try{(await fetch("/api/user/basic-profile",{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({name:s.name,email:s.email})})).ok?alert("¡Perfil actualizado con éxito!"):alert("Hubo un problema al guardar los cambios.")}catch(r){console.error("Error:",r)}finally{d(!1)}};return b?e.jsx("div",{className:"text-center py-20 text-gray-400 italic",children:"Cargando información del servidor..."}):e.jsx("div",{className:"max-w-xl mx-auto",children:e.jsxs("form",{onSubmit:m,className:"space-y-8",children:[e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-6 flex flex-col items-center border border-gray-100 shadow-sm",children:[e.jsx(j,{initialImageUrl:s.avatar,uploadUrl:route("upload.avatar"),onUploadSuccess:x}),e.jsx("h3",{className:"mt-2 text-sm font-semibold text-gray-900",children:"Foto de perfil"}),e.jsx("p",{className:"text-[11px] text-gray-500 mt-1 text-center",children:"Esta foto será visible para otros usuarios en la plataforma."})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"group",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-widest mb-2 ml-1",children:"Nombre de usuario"}),e.jsxs("div",{className:"relative",children:[e.jsx(g,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 group-focus-within:text-blue-500 w-4 h-4 transition-colors"}),e.jsx("input",{type:"text",value:s.name,onChange:a=>c("name",a.target.value),className:"w-full pl-10 pr-4 py-3 bg-white border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all shadow-sm",placeholder:"Ej. JuanPerez2026",required:!0})]})]}),e.jsxs("div",{className:"group",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-widest mb-2 ml-1",children:"Correo electrónico"}),e.jsxs("div",{className:"relative",children:[e.jsx(y,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 group-focus-within:text-blue-500 w-4 h-4 transition-colors"}),e.jsx("input",{type:"email",value:s.email,onChange:a=>c("email",a.target.value),className:"w-full pl-10 pr-4 py-3 bg-white border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all shadow-sm",placeholder:"ejemplo@correo.com",required:!0})]})]})]}),e.jsx("div",{className:"pt-2",children:e.jsx("button",{type:"submit",disabled:o,className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-3.5 rounded-xl font-bold transition-all shadow-lg shadow-blue-200 disabled:opacity-50",children:o?"Sincronizando...":"Guardar cambios del perfil"})})]})})};export{k as default};
