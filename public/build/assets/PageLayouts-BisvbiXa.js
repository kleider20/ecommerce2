import{r as c,j as e,H as S,a as u}from"./app-_a53eJXV.js";import{A as E}from"./AutoLayoutResolver-DcB31Z3Z.js";import{P}from"./plus-CLABzJA4.js";import{T as N}from"./triangle-alert-DNBr1F9L.js";import{P as k}from"./pen-line-CLf2kXr1.js";import{T as L}from"./trash-2-BSzdQTpK.js";import"./createLucideIcon-mfdPizJi.js";const $=({configurations:v,availablePages:o=[],availableRoles:h=[],availablePermissions:g=[],availableLayouts:n=[],success:y})=>{const[R,d]=c.useState(!1),[i,m]=c.useState(null),[t,l]=c.useState({page_name:Array.isArray(o)&&o.length>0?o[0]:"",layout_path:Array.isArray(n)&&n.length>0?n[0]:"",role:"",permission:""}),b=Array.isArray(o)?o:[],j=Array.isArray(h)?h:[],x=Array.isArray(g)?g:[],f=Array.isArray(n)?n:[],w=c.useMemo(()=>{const s={};return x.forEach(r=>{const a=r.category||"General";s[a]||(s[a]=[]),s[a].push(r)}),s},[x]),A=s=>{s.preventDefault(),i?u.put(route("admin.page-layouts.update",{pageLayout:i}),t):u.post(route("admin.page-layouts.store"),t),l({page_name:b[0]||"",layout_path:f[0]||"",role:"",permission:""}),d(!1),m(null)},_=s=>{l({page_name:s.page_name,layout_path:s.layout_path,role:s.role||"",permission:s.permission||""}),m(s.id),d(!0)},C=s=>{confirm("¿Eliminar configuración?")&&u.delete(route("admin.page-layouts.destroy",{pageLayout:s}))};return e.jsx(E,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(S,{title:"Gestor de Layouts por Página"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestor de Layouts por Página"}),e.jsx("p",{className:"text-gray-600",children:"Asigna layouts específicos a cada página con control de acceso por roles y permisos."})]}),y&&e.jsx("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg",children:y}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:i?"Editar Configuración":"Nueva Configuración"}),e.jsxs("form",{onSubmit:A,className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Página"}),e.jsxs("select",{value:t.page_name,onChange:s=>l({...t,page_name:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Seleccione una página"}),b.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Layout"}),e.jsxs("select",{value:t.layout_path,onChange:s=>l({...t,layout_path:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Seleccione un layout"}),f.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rol"}),e.jsxs("select",{value:t.role,onChange:s=>l({...t,role:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Sin rol específico"}),j.map(s=>e.jsx("option",{value:s.name,children:s.display_name},s.name))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Permiso"}),e.jsxs("select",{value:t.permission,onChange:s=>l({...t,permission:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Sin permiso específico"}),Object.entries(w).map(([s,r])=>e.jsx("optgroup",{label:s,children:r.map(a=>e.jsx("option",{value:a.name,children:a.display_name},a.name))},s))]})]}),e.jsxs("div",{className:"flex gap-2 md:col-span-2 lg:col-span-4",children:[e.jsxs("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors",children:[e.jsx(P,{className:"w-4 h-4"}),i?"Actualizar Configuración":"Crear Configuración"]}),i&&e.jsx("button",{type:"button",onClick:()=>{d(!1),m(null)},className:"bg-gray-300 hover:bg-gray-400 text-gray-700 px-4 py-2 rounded-lg transition-colors",children:"Cancelar"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold",children:"Configuraciones Actuales"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Página"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Layout"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Rol"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Permiso"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Acciones"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:v.map(s=>{const r=j.find(p=>p.name===s.role),a=x.find(p=>p.name===s.permission);return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:s.page_name}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 font-mono",children:s.layout_path}),e.jsx("td",{className:"px-6 py-4 text-sm",children:r?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${r.color.replace("text-","bg-").replace("bg-","")} ${r.color.includes("text-")?r.color.replace("text-","bg-"):""}`}),e.jsx("span",{children:r.display_name}),r.users_count>0&&e.jsxs("span",{className:"text-xs text-gray-500",children:["(",r.users_count," usuarios)"]})]}):s.role?s.role:"—"}),e.jsx("td",{className:"px-6 py-4 text-sm",children:a?e.jsxs("div",{className:"flex items-center gap-1",children:[a.is_critical&&e.jsx(N,{className:"w-3 h-3 text-red-500"}),e.jsx("span",{children:a.display_name}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",a.category,")"]})]}):s.permission?s.permission:"—"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:[e.jsx("button",{onClick:()=>_(s),className:"text-blue-600 hover:text-blue-900 p-1 mr-2",title:"Editar",children:e.jsx(k,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>C(s.id),className:"text-red-600 hover:text-red-900 p-1",title:"Eliminar",children:e.jsx(L,{className:"w-4 h-4"})})]})]},s.id)})})]})})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Iconos y colores"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-xs text-blue-800",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"w-3 h-3 text-red-500"}),e.jsx("span",{children:"Permiso crítico (no se puede eliminar)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),e.jsx("span",{children:"Color del rol (configurable)"})]})]})]})]})})};export{$ as default};
