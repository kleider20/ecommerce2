import{j as e,L as G,a as j,R as q,r as u,H as I,y as P}from"./app-veqlbRop.js";import{S as f}from"./shield-CDJkofxC.js";import{P as U,T as K}from"./trash-2-BMoJuRuX.js";import{S as Q}from"./search-Cjp4NVQJ.js";import{B as W,C as X,K as k,A as J}from"./key-sW03DK2Y.js";import{U as V}from"./user-9-404n72.js";import{B as Y,U as b,S as Z}from"./SuperAdminLayout-CZDjE9N7.js";import{P as ee}from"./package-DNGG6oYV.js";import{G as se}from"./globe-yg3PjqQS.js";import{P as re}from"./pen-line-CFB-lqlt.js";import{c as E}from"./createLucideIcon-CyTgOFtE.js";import{L as _}from"./lock-Y1pKtxzX.js";import{C as te}from"./circle-check-big-oELdVuLo.js";import"./x-CXVp1HMM.js";import"./credit-card-Cew9DDo5.js";const ae=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],A=E("circle-x",ae);const ie=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],ne=E("user-plus",ie),le=({canCreateRoles:s})=>e.jsx("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-200",children:e.jsx("div",{className:"px-6 py-5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl flex items-center justify-center shadow-md",children:e.jsx(f,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 tracking-tight",children:"Gesti칩n de Roles y Permisos"}),e.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:"Administra roles, permisos y configuraciones de acceso del sistema"})]})]}),s&&e.jsxs(G,{href:route("roles.create"),className:"inline-flex items-center px-5 py-2.5 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-medium rounded-xl shadow-md hover:shadow-lg transition-all duration-200 transform hover:-translate-y-0.5 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Nuevo Rol"]})]})})}),oe=({searchTerm:s,onSearchChange:c,filterRole:n,onFilterChange:l,roles:m})=>e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Buscar roles por nombre o descripci칩n...",value:s,onChange:a=>c(a.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("select",{value:n,onChange:a=>l(a.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"Todos los roles"}),m.map(a=>e.jsx("option",{value:a.name,children:a.display_name},a.id))]})})]})}),ce={Shield:f,Users:b,Key:k,Globe:se,Package:ee,Building2:Y,User:V,Crown:X,Bike:W},de=({role:s,isSelected:c,onClick:n,canModifyRole:l,isSuperAdmin:m,onToggleRegister:a,onDeleteRole:p})=>{const d=ce[s.icon]||f,g=l(s);return e.jsxs("div",{className:`p-6 rounded-xl border-2 cursor-pointer transition-all duration-200 hover:shadow-lg ${c?"border-blue-500 bg-blue-50 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"}`,onClick:n,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${s.color}`,children:e.jsx(d,{className:"w-6 h-6"})}),e.jsx("h3",{className:"font-semibold text-gray-900 text-lg",children:s.display_name})]}),m&&e.jsx("button",{onClick:t=>{t.stopPropagation(),a(s.id)},className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none ${s.show_in_register?"bg-green-500":"bg-gray-300"}`,"aria-pressed":s.show_in_register,title:s.show_in_register?"Desactivar en registro":"Activar en registro",children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s.show_in_register?"translate-x-4":"translate-x-0.5"}`})})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:s.description}),e.jsx("span",{className:`inline-flex px-2 py-0.5 rounded-full text-xs font-medium ${s.show_in_register?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:s.show_in_register?"Activo en registro":"Inactivo en registro"}),e.jsxs("div",{className:"mt-4 flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-4 text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(b,{className:"w-4 h-4"}),s.users_count||0]}),e.jsxs("span",{className:"flex items.center gap-1",children:[e.jsx(k,{className:"w-4 h-4"}),s.permissions_count||0]})]}),e.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.color}`,children:s.name})]}),g&&e.jsxs("div",{className:"flex justify-end gap-2 pt-3 border-t border-gray-100",children:[e.jsx("button",{className:"flex items-center justify-center w-9 h-9 text-gray-600 bg-white border border-gray-300 rounded-lg hover:bg-blue-50 hover:text-blue-700 transition-all shadow-sm hover:shadow-md",onClick:t=>{t.stopPropagation(),j.visit(route("roles.edit",s.id))},"aria-label":`Editar ${s.display_name}`,children:e.jsx(re,{className:"w-4 h-4"})}),e.jsx("button",{className:"flex items-center justify-center w-9 h-9 text-gray-600 bg-white border border-gray-300 rounded-lg hover:bg-red-50 hover:text-red-700 transition-all shadow-sm hover:shadow-md",onClick:t=>{t.stopPropagation(),p(s.id)},"aria-label":`Eliminar ${s.display_name}`,children:e.jsx(K,{className:"w-4 h-4"})})]})]})},L={Shield:f,Users:b},me=({selectedRole:s,permissions:c,canModifyPermissions:n,onBack:l,authUser:m})=>{const a=t=>c.some(i=>i.id===t&&i.users_count>0),d=(t=>c.filter(i=>i.roles&&i.roles.some(o=>o.id===t)))(s.id),g=c.filter(t=>!d.find(i=>i.id===t.id));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:l,className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(J,{className:"w-5 h-5"})}),e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${s.color}`,children:L[s.icon]?q.createElement(L[s.icon],{className:"w-5 h-5"}):e.jsx(f,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:s.display_name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.description})]})]}),n&&e.jsxs("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors",children:[e.jsx(ne,{className:"w-4 h-4"})," Asignar Usuarios"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900",children:["Permisos Asignados (",d.length,")"]}),n&&e.jsx("button",{className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"+ Agregar Permiso"})]}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:d.length>0?d.map(t=>{const i=a(t.id),o=t.is_critical,x=n&&!i&&!o;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:t.display_name}),e.jsx("p",{className:"text-sm text-gray-600",children:t.description}),(i||o)&&e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[i&&e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[e.jsx(b,{className:"w-3 h-3 mr-1"})," Asignado"]}),o&&e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[e.jsx(_,{className:"w-3 h-3 mr-1"})," Cr칤tico"]})]})]}),x?e.jsx("button",{onClick:()=>{confirm("쯈uitar permiso?")&&j.post(route("roles.permissions.detach",{role:s.id,permission:t.id}))},className:"p-1 text-red-600 hover:text-red-700 hover:bg-red-100 rounded transition-colors",children:e.jsx(A,{className:"w-4 h-4"})}):e.jsx("div",{className:"text-gray-400",children:"游"})]},t.id)}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(k,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),e.jsx("p",{children:"No hay permisos asignados"})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4",children:["Permisos Disponibles (",g.length,")"]}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:g.length>0?g.map(t=>{const i=a(t.id),o=t.is_critical,x=n&&!o;return e.jsxs("div",{className:`flex items-center justify-between p-3 border rounded-lg ${x?"border-gray-200 hover:border-blue-300 transition-colors":"border-gray-200 bg-gray-50 cursor-not-allowed"}`,children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:t.display_name}),e.jsx("p",{className:"text-sm text-gray-600",children:t.description}),(i||o)&&e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[i&&e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[e.jsx(b,{className:"w-3 h-3 mr-1"})," Asignado"]}),o&&e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[e.jsx(_,{className:"w-3 h-3 mr-1"})," Cr칤tico"]})]})]}),x?e.jsx("button",{onClick:()=>{j.post(route("roles.permissions.attach",{role:s.id,permission:t.id}))},className:"p-1 text-green-600 hover:text-green-700 hover:bg-green-100 rounded transition-colors",children:e.jsx(te,{className:"w-4 h-4"})}):e.jsx("div",{className:"text-gray-400",children:o?e.jsx(_,{className:"w-4 h-4"}):e.jsx(A,{className:"w-4 h-4"})})]},t.id)}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(f,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),e.jsx("p",{children:"Todos los permisos est치n asignados"})]})})]})]})]})},xe=({isOpen:s,onClose:c,onConfirm:n,title:l="Confirmar acci칩n",message:m="쮼st치 seguro de realizar esta acci칩n? Esta operaci칩n no se puede deshacer.",confirmText:a="S칤, eliminar",cancelText:p="Cancelar"})=>s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full p-6 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:l})]}),e.jsx("p",{className:"text-gray-600 mb-6",children:m}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:c,className:"flex-1 px-4 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 font-medium transition-colors",children:p}),e.jsx("button",{onClick:n,className:"flex-1 px-4 py-2.5 bg-red-600 hover:bg-red-700 text-white font-medium rounded-lg shadow-sm hover:shadow transition-colors",children:a})]})]})}):null,Re=({roles:s,permissions:c,authUser:n})=>{const[l,m]=u.useState(null),[a,p]=u.useState(""),[d,g]=u.useState("all"),[t,i]=u.useState(s),[o,x]=u.useState(!1),[N,$]=u.useState(null),v=n.roles.some(r=>r.name==="super_admin"),w=n.roles.some(r=>r.name==="admin"),T=l&&n.roles.some(r=>r.id===l.id),B=l&&l.name==="super_admin",D=v,M=r=>!(r.name==="super_admin"&&v||n.roles.some(h=>h.id===r.id)||r.name==="super_admin"&&w),z=!B&&!T,S=u.useMemo(()=>t.filter(r=>!(w&&r.name==="super_admin")),[t,w]),R=u.useMemo(()=>S.filter(r=>{const h=r.display_name.toLowerCase().includes(a.toLowerCase())||r.description&&r.description.toLowerCase().includes(a.toLowerCase()),C=d==="all"||r.name===d;return h&&C}),[S,a,d]),H=r=>{j.patch(route("roles.toggle-register",r),{},{preserveScroll:!0,onSuccess:h=>{const C=t.map(y=>y.id===r?{...y,show_in_register:!y.show_in_register}:y);i(C)},onError:h=>{console.error("Error al actualizar:",h)}})},O=r=>{$(r),x(!0)},F=()=>{j.delete(route("roles.destroy",N),{onSuccess:()=>{const r=t.filter(h=>h.id!==N);i(r),x(!1),P.success("춰Rol eliminado exitosamente!",{position:"top-center",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})},onError:r=>{P.error(r?.error||"Error al eliminar el rol",{position:"top-center",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}})};return e.jsx(e.Fragment,{children:e.jsxs(Z,{children:[e.jsx(I,{title:"Gesti칩n de Roles y Permisos"}),e.jsx(le,{canCreateRoles:D}),e.jsx("div",{className:"mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l?e.jsx(me,{selectedRole:l,permissions:c,canModifyPermissions:z,onBack:()=>m(null),authUser:n}):e.jsxs("div",{className:"space-y-8",children:[e.jsx(oe,{searchTerm:a,onSearchChange:p,filterRole:d,onFilterChange:g,roles:R}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:R.map(r=>e.jsx(de,{role:r,isSelected:l?.id===r.id,onClick:()=>m(r),canModifyRole:M,isSuperAdmin:v,onToggleRegister:H,onDeleteRole:O},r.id))})]})}),e.jsx(xe,{isOpen:o,onClose:()=>x(!1),onConfirm:F,title:"Eliminar rol",message:`쮼st치 seguro de eliminar el rol "${t.find(r=>r.id===N)?.display_name}"? Esta acci칩n no se puede deshacer y los usuarios asignados quedar치n sin rol.`,confirmText:"S칤, eliminar",cancelText:"Cancelar"})]})})};export{Re as default};
